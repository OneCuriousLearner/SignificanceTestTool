# 模型对比统计分析工具 - 使用总结

## 🎉 工具开发完成

我已经为你构建了一个完整的模型对比统计分析工具，能够灵活地对比CSV文件中多个模型的回答总分差距是否显著。

## 📁 文件结构

```
多轮标注工具/
├── model_comparison_tool.py      # 核心工具类
├── example_usage.py              # 详细使用示例
├── quick_analysis.py             # 快速分析脚本
├── README_模型对比工具.md         # 详细使用说明
├── 工具使用总结.md               # 本文件
└── 归因组合_analysis.png         # 生成的分析图表
```

## ✨ 主要功能特点

### 1. 灵活的数据处理
- **自动字段检测**: 智能识别分数字段（如"分_模型名"）
- **手动字段设置**: 支持自定义字段名称和模型名称
- **数据清理**: 自动处理缺失值和异常值
- **多编码支持**: 支持UTF-8、GBK等编码格式

### 2. 多种统计检验方法
- **Wilcoxon符号秩检验** (推荐): 非参数检验，对数据分布要求低
- **配对t检验**: 参数检验，需要数据近似正态分布
- **Mann-Whitney U检验**: 独立样本非参数检验

### 3. 全面的分析功能
- **基本统计信息**: 均值、标准差、中位数、分位数等
- **两两模型对比**: 所有模型间的显著性检验
- **基线模型对比**: 与指定基线模型的对比分析
- **可视化分析**: 箱线图、直方图、相关性热力图等

### 4. 详细的结果输出
- **统计报告**: 自动生成完整的分析报告
- **显著性判断**: 自动判断差异是否显著
- **模型排名**: 按平均得分排序
- **图表保存**: 支持保存分析图表

## 🚀 快速使用方法

### 方法1: 使用快速分析脚本
```bash
# 基本使用
python3 quick_analysis.py "归因组合.csv"

# 指定基线模型
python3 quick_analysis.py "归因组合.csv" "分_基线模型"

# 指定检验方法和显著性水平
python3 quick_analysis.py "归因组合.csv" "分_基线模型" "wilcoxon" 0.05
```

### 方法2: 使用Python代码
```python
from model_comparison_tool import ModelComparisonTool

# 初始化工具
tool = ModelComparisonTool("your_data.csv")

# 加载数据
df = tool.load_data()

# 自动检测分数字段
score_columns = tool.detect_score_columns(pattern="分_")

# 清理数据
score_df = tool.clean_score_data()

# 生成分析报告
report = tool.generate_report(score_df, test_type='wilcoxon', alpha=0.05)
print(report)

# 创建可视化
tool.create_visualization(score_df)
```

## 📊 实际测试结果

使用你的"归因组合.csv"文件进行测试，结果如下：

### 数据概览
- **总样本数**: 13,879行
- **有效样本数**: 9,180行（清理后）
- **检测到模型**: 2个
  - 元宝_DSv31_v3_端到端（开联）
  - 元宝_turbo_端到端(开联)

### 分析结果
- **最佳模型**: 元宝_DSv31_v3_端到端（开联）
- **平均得分**: 0.4368 vs 0.3489
- **统计显著性**: p < 0.0001 (高度显著)
- **结论**: 两个模型存在显著差异

## 🎯 适用场景

### 1. 模型性能评估
- 对比多个模型在同一数据集上的表现
- 判断模型间差异是否显著
- 识别最佳模型

### 2. 基线模型对比
- 与基准模型进行对比
- 评估新模型的改进效果
- 验证模型优化效果

### 3. 统计显著性检验
- 使用Wilcoxon符号秩检验判断差异显著性
- 生成详细的统计报告
- 支持多种检验方法

## 🔧 高级功能

### 1. 自定义字段设置
```python
# 手动设置分数字段
score_columns = ["分_模型A", "分_模型B", "分_模型C"]
model_names = ["模型A", "模型B", "模型C"]
tool.set_score_columns(score_columns, model_names)
```

### 2. 基线模型对比
```python
# 与基线模型对比
baseline_results = tool.baseline_comparison(
    score_df, 
    baseline_model="分_基线模型", 
    test_type='wilcoxon', 
    alpha=0.05
)
```

### 3. 多种统计检验
```python
# 使用不同的统计检验方法
pairwise_results = tool.pairwise_comparison(
    score_df, 
    test_type='wilcoxon',  # 或 'ttest', 'mannwhitney'
    alpha=0.05
)
```

## 📈 输出结果说明

### 1. 基本统计信息
- **样本数**: 有效数据点数量
- **均值**: 平均得分
- **标准差**: 得分离散程度
- **中位数**: 中位数得分
- **分位数**: 25%和75%分位数

### 2. 统计检验结果
- **检验统计量**: 统计检验的计算值
- **p值**: 显著性概率
- **是否显著**: 是否在指定显著性水平下显著
- **均值差异**: 两个模型得分的平均差异

### 3. 可视化图表
- **箱线图**: 显示得分分布和异常值
- **直方图**: 显示得分分布密度
- **条形图**: 对比平均得分
- **相关性热力图**: 显示模型间相关性

## ⚠️ 使用注意事项

### 1. 数据要求
- CSV文件必须包含分数字段
- 分数字段应为数值类型
- 建议样本量不少于30个

### 2. 统计检验选择
- **推荐使用Wilcoxon符号秩检验**: 对数据分布要求较低
- **配对t检验**: 需要数据近似正态分布
- **Mann-Whitney U检验**: 适用于独立样本

### 3. 显著性水平
- 默认使用α=0.05
- 可根据需要调整显著性水平
- 注意多重比较问题

## 🎉 总结

这个工具完全满足你的需求：

1. ✅ **灵活定义字段**: 支持自动检测和手动设置分数字段
2. ✅ **可扩展性**: 支持任意数量的模型对比
3. ✅ **统计显著性检验**: 使用Wilcoxon符号秩检验等专业统计方法
4. ✅ **基线模型对比**: 支持与指定基线模型的对比分析
5. ✅ **详细报告**: 生成完整的统计分析报告
6. ✅ **可视化分析**: 提供多种图表展示结果

工具已经过实际数据测试，运行正常，可以直接使用！
